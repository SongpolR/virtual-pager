<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Order Status</title>
    <style>
        body { font-family: sans-serif; text-align: center; padding: 60px; }
        #status { font-size: 1.5em; margin-top: 40px; }
    </style>
</head>
<body>
<h2>â˜• My Shop</h2>
<div id="status">Preparing your order...</div>
<audio id="ding" src="ding.wav" loop></audio>

<script src="/socket.io/socket.io.js"></script>
<script>
    const orderNo = new URL(location.href).searchParams.get('no');
    document.title = `Order #${orderNo}`;
    const statusEl = document.getElementById('status');
    const ding = document.getElementById('ding');
    const socket = io();

    socket.on('order-status', data => {
        if (data.orderNo !== orderNo) return;
        if (data.status === 'READY') {
            statusEl.textContent = `âœ… Order #${orderNo} is ready!`;
            ding.play();
            navigator.vibrate?.([300, 150, 300, 150, 300]);
        } else if (data.status === 'DONE') {
            statusEl.textContent = `ðŸ§¾ Order #${orderNo} collected. Thank you!`;
            ding.pause();
            ding.currentTime = 0;
        }
    });
</script>
</body>
</html>
